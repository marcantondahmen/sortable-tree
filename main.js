/*! For license information please see main.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SortableTree=t():e.SortableTree=t()}(self,(()=>(()=>{"use strict";var e={d:(t,o)=>{for(var s in o)e.o(o,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:o[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{default:()=>m});const o=e=>e.text,s={tree:"tree",node:"tree__node",nodeHover:"tree__node--hover",nodeDropBefore:"tree__node--drop-before",nodeDropInside:"tree__node--drop-inside",nodeDropAfter:"tree__node--drop-after",label:"tree__label",subnodes:"tree__subnodes",collapseButton:"tree__collapse"},n=e=>{},r=(e,t)=>!0,l=(e,t=[],o={},s=null)=>{const n=document.createElement(e);t.forEach((e=>{n.classList.add(e)}));for(const[e,t]of Object.entries(o))n.setAttribute(e,t);return s&&s.appendChild(n),n};class i extends HTMLElement{set label(e){this._label=e}get label(){return this._label}set subnodes(e){this._nodes=e}get subnodes(){return this._nodes}constructor(){super()}connectedCallback(){this.setAttribute("id",(()=>{const e=()=>Math.floor(65536*(1+Math.random())).toString(16).substring(1);return`${e()}${e()}-${e()}-${e()}-${e()}-${e()}${e()}${e()}`})()),this.setAttribute("draggable","true")}}i.TAG_NAME="tree-node";const a=({node:e,eventName:t,handler:o,tree:s})=>{e.addEventListener(t,(e=>{o(e,s)}),!1)};var d;!function(e){e.BEFORE="BEFORE",e.INSIDE="INSIDE",e.AFTER="AFTER"}(d||(d={}));const c=e=>{const t=e.clientY,o=p(e).label.getBoundingClientRect(),s=Math.round(o.height/4);return o.top+s>t?d.BEFORE:o.bottom-s<t?d.AFTER:d.INSIDE},p=e=>e.target.closest(i.TAG_NAME),h=(e,t)=>{p(e).classList.remove(t.styles.nodeDropAfter,t.styles.nodeDropBefore,t.styles.nodeDropInside)},u=(e,t)=>{e.stopPropagation(),e.dataTransfer.setData("text",e.target.id),e.dataTransfer.effectAllowed="move"},f=(e,t)=>{e.stopPropagation(),e.preventDefault(),h(e,t);const o=p(e);if(!o)return!1;const s=o.parentElement.parentElement,n=e.dataTransfer.getData("text"),r=c(e),l=document.getElementById(n);if(l.contains(o))return!1;if(t.lockRootLevel&&!o.parentElement.closest(i.TAG_NAME)&&(r===d.BEFORE||r===d.AFTER))return!1;if(!t.confirm(l,s))return!1;if(r===d.BEFORE)return o.parentNode.insertBefore(l,o),t.onDrop(l,s),!1;if(r===d.AFTER){const e=o.nextElementSibling;return e?(o.parentNode.insertBefore(l,e),t.onDrop(l,s)):(o.parentNode.appendChild(l),t.onDrop(l,s)),!1}return o.subnodes.appendChild(l),t.onDrop(l,o),!1},b=(e,t)=>{e.preventDefault(),e.dataTransfer.dropEffect="move",((e,t)=>{const o=p(e),s=c(e);o.classList.toggle(t.styles.nodeDropBefore,s===d.BEFORE),o.classList.toggle(t.styles.nodeDropInside,s===d.INSIDE),o.classList.toggle(t.styles.nodeDropAfter,s===d.AFTER)})(e,t)},g=(e,t)=>{h(e,t)},E=(e,t)=>{h(e,t)},m=class{constructor({nodes:e,element:t,renderLabel:l,styles:i,lockRootLevel:a,onChange:d,initCollapseLevel:c,confirm:p}){this.iconShowSubnodes='<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-caret-right-fill" viewBox="0 0 16 16"><path d="m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"/></svg>',this.iconHideSubnodes='<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-caret-down-fill" viewBox="0 0 16 16"><path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/></svg>',this.defineElements(),this.root=t,this.styles=Object.assign(s,i),this.renderLabel=l||o,this.lockRootLevel=void 0===a||a,this.onChange=d||n,this.confirm=p||r,this.initCollapseLevel=void 0===c?2:c,t.classList.add(this.styles.tree),this.render({nodes:e,element:t})}defineElements(){try{customElements.define(i.TAG_NAME,i)}catch(e){}}render({nodes:e,element:t},o=0){o++,e.forEach((e=>{const s=l(i.TAG_NAME,[this.styles.node],e.attributes,t),n=l("div",[this.styles.label],{},s),r=l("div",[this.styles.subnodes],{},s),d=l("span",[this.styles.collapseButton],{},s);this.toggleCollapseButton(s,d,o>this.initCollapseLevel),d.addEventListener("click",(()=>{this.toggleCollapseButton(s,d,s.hasAttribute("open"))})),s.label=n,s.subnodes=r,n.innerHTML=this.renderLabel(e),((e,t)=>{const o={dragstart:u,drop:f,dragover:b,dragend:E,dragleave:g};for(const[s,n]of Object.entries(o))a({node:e,eventName:s,handler:n,tree:t})})(s,this),e.nodes&&this.render({nodes:e.nodes,element:r},o)}))}toggleCollapseButton(e,t,o){o?(e.removeAttribute("open"),t.innerHTML=this.iconShowSubnodes):(e.setAttribute("open","true"),t.innerHTML=this.iconHideSubnodes)}parseTree(e){const t=Array.from(e.querySelectorAll(`:scope > ${i.TAG_NAME}`)),o=[];return t.forEach((e=>{o.push({element:e,id:e.id,subnodes:this.parseTree(e.subnodes)})})),o}onDrop(e,t){const o={nodes:this.parseTree(this.root),moved:e,parentNode:t},s=t.querySelector(`:scope > .${this.styles.collapseButton}`);this.toggleCollapseButton(t,s,!1),this.onChange(o)}};return t.default})()));