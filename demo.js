(()=>{var e={788:()=>{class e extends HTMLElement{constructor(){super()}connectedCallback(){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",this.highlight.bind(this)):this.highlight()}highlight(){const e=this.textContent;this.innerHTML=`\n\t\t\t<pre><code class="ts">${e}</code></pre>\n\t\t`;const t=this.querySelector("code");window.hljs.highlightElement(t),window.hljs.lineNumbersBlock(t,{singleLine:!0})}}customElements.define("demo-code",e)},651:()=>{class e extends HTMLElement{constructor(){super()}connectedCallback(){const e=this.getAttribute("name"),t=document.createElement("details"),n=document.createElement("summary"),o=this.createEmbed("nodes");n.textContent="full example data",t.appendChild(n),t.appendChild(o),this.appendChild(this.createEmbed(e)),this.appendChild(t)}createEmbed(e){const t=document.createElement("script");return t.setAttribute("src",this.createSrc(e)),t}createSrc(e){return`https://marcantondahmen.github.io/emgithub/embed-v2.js?target=https%3A%2F%2Fgithub.com%2Fmarcantondahmen%2Fsortable-tree%2Fblob%2Fmaster%2Fdemo%2Fexamples%2F${e}.ts%3Fts%3D2&style=dark&type=code&showLineNumbers=on&showCopy=on`}}customElements.define("demo-embed",e)},299:()=>{class e extends HTMLElement{constructor(){super()}connectedCallback(){this.classList.add("toc"),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",this.render.bind(this)):this.render()}render(){const e=Array.from(document.querySelectorAll("h2")),t=[];if(!e)return;e.forEach((e=>{e.id=e.textContent.toLowerCase().replace(/\W+/g,"-"),t.push({href:`#${e.id}`,text:e.textContent})})),t.forEach((e=>{const t=document.createElement("a");t.href=e.href,t.textContent=e.text,this.appendChild(t)}));const n=new IntersectionObserver((e=>{e.forEach((e=>{const t=e.target.getAttribute("id"),n=document.querySelector(`demo-toc a[href="#${t}"]`);try{e.intersectionRatio>0?n.classList.add("active"):n.classList.remove("active")}catch(e){}}))}));Array.from(document.querySelectorAll("h2")).forEach((e=>{n.observe(e)}))}}customElements.define("demo-toc",e)}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,n),s.exports}(()=>{"use strict";n(788),n(651),n(299);const e=[{data:{title:"Homepage",path:"/"},nodes:[{data:{title:"Page Number One",path:"/number-one"},nodes:[{data:{title:"Subpage",path:"/number-one/subpage"},nodes:[]},{data:{title:"Another Subpage",path:"/number-one/another"},nodes:[{data:{title:"Deep Nested Page",path:"/number-one/another/deep-nested"},nodes:[]}]}]},{data:{title:"Page Two",path:"/page-two"},nodes:[]},{data:{title:"Third Page",path:"/third-page"},nodes:[]}]}];var t=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function a(e){try{d(o.next(e))}catch(e){s(e)}}function i(e){try{d(o.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}d((o=o.apply(e,t||[])).next())}))};const o=e=>`<span>${e.title}</span>`,r={collapsed:'\n\t\t<svg\n\t\txmlns="http://www.w3.org/2000/svg" \n\t\twidth="1em" \n\t\theight="1em" \n\t\tfill="currentColor" \n\t\tclass="bi bi-caret-right-fill" \n\t\tviewBox="0 0 16 16">\n\t\t\t<path d="m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"/>\n\t\t</svg>',open:'\n\t\t<svg \n\t\txmlns="http://www.w3.org/2000/svg" \n\t\twidth="1em" \n\t\theight="1em" \n\t\tfill="currentColor" \n\t\tclass="bi bi-caret-down-fill" \n\t\tviewBox="0 0 16 16">\n\t\t\t<path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/>\n\t\t</svg>\n\t'},s={tree:"tree",node:"tree__node",nodeHover:"tree__node--hover",nodeDragging:"tree__node--dragging",nodeDropBefore:"tree__node--drop-before",nodeDropInside:"tree__node--drop-inside",nodeDropAfter:"tree__node--drop-after",label:"tree__label",subnodes:"tree__subnodes",collapse:"tree__collapse"},a=({nodes:e,movedNode:n,srcParentNode:o,targetParentNode:r})=>t(void 0,void 0,void 0,(function*(){})),i=(e,n)=>t(void 0,void 0,void 0,(function*(){})),d=(e,n)=>t(void 0,void 0,void 0,(function*(){return!0})),l=(e,t=[],n=null)=>{const o=document.createElement(e);return t.forEach((e=>{o.classList.add(e)})),n&&n.appendChild(o),o};class c extends HTMLElement{static create({data:e,renderLabel:t,icons:n,styles:o,parent:r,onClick:s,draggable:a}){const i=l(c.TAG_NAME,[o.node],r),d=l("div",[o.label],i),u=l("div",[o.subnodes],i),h=l("span",[o.collapse],i);return d.innerHTML=t(e),h.innerHTML=n.collapsed,h.addEventListener("click",i.toggle.bind(i)),d.addEventListener("click",(e=>{s(e,i)})),a&&i.setAttribute("draggable","true"),i._data=e,i._icons=n,i._label=d,i._nodes=u,i._collapseButton=h,i}get data(){return this._data}get label(){return this._label}get subnodes(){return this._nodes}get subnodesData(){const e=[];return Array.from(this._nodes.children).forEach((t=>{e.push(t.data)})),e}get id(){return this._id}constructor(){super(),this._id=((e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),""))()}collapse(e){e?(this.removeAttribute("open"),this._collapseButton.innerHTML=this._icons.collapsed):(this.setAttribute("open","true"),this._collapseButton.innerHTML=this._icons.open)}toggle(){this.collapse(this.hasAttribute("open"))}reveal(){((e,t)=>{const n=[];let o=this.closest(e);for(;null!==o;)n.push(o),o=o.parentNode.closest(e);return n})(c.TAG_NAME).forEach((e=>{e.collapse(!1)}))}}c.TAG_NAME="sortable-tree-node";const u=({node:e,eventName:t,handler:n,tree:o})=>{e.addEventListener(t,(e=>{n(e,o)}),!1)};var h;!function(e){e.BEFORE="BEFORE",e.INSIDE="INSIDE",e.AFTER="AFTER"}(h||(h={}));const p=e=>{const t=e.clientY,n=m(e).label.getBoundingClientRect(),o=Math.round(n.height/4);return n.top+o>t?h.BEFORE:n.bottom-o<t?h.AFTER:h.INSIDE},m=e=>e.target.closest(c.TAG_NAME),g=e=>{const t=null==e?void 0:e.parentElement.parentElement;return(null==t?void 0:t.tagName.toLowerCase())!==c.TAG_NAME?null:t},f=(e,t)=>{m(e).classList.remove(t.styles.nodeDropAfter,t.styles.nodeDropBefore,t.styles.nodeDropInside)},v=(e,t)=>{e.stopPropagation();const n=e.target;n.tagName.toLowerCase()===c.TAG_NAME&&(e.dataTransfer.setData("text",n.id),e.dataTransfer.effectAllowed="move",n.classList.add(t.styles.nodeDragging))},b=(e,t)=>{return n=void 0,o=void 0,s=function*(){e.stopPropagation(),e.preventDefault(),f(e,t);const n=m(e);if(!n)return!1;const o=g(n),r=e.dataTransfer.getData("text"),s=p(e),a=t.getNode(r);if(!a||(null==a?void 0:a.contains(n)))return!1;const i=g(a);if(t.lockRootLevel&&!(null==n?void 0:n.parentElement.closest(c.TAG_NAME))&&(s===h.BEFORE||s===h.AFTER))return!1;if(s===h.BEFORE)return!!(yield t.confirm(a,o))&&(n.parentNode.insertBefore(a,n),t.onDrop(a,i,o),!1);if(s===h.AFTER){if(!(yield t.confirm(a,o)))return!1;const e=n.nextElementSibling;return e?(n.parentNode.insertBefore(a,e),t.onDrop(a,i,o)):(n.parentNode.appendChild(a),t.onDrop(a,i,o)),!1}return!!(yield t.confirm(a,n))&&(n.subnodes.appendChild(a),t.onDrop(a,i,n),!1)},new((r=void 0)||(r=Promise))((function(e,t){function a(e){try{d(s.next(e))}catch(e){t(e)}}function i(e){try{d(s.throw(e))}catch(e){t(e)}}function d(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(a,i)}d((s=s.apply(n,o||[])).next())}));var n,o,r,s},E=(e,t)=>{e.preventDefault(),e.dataTransfer.dropEffect="move",((e,t)=>{const n=m(e),o=p(e);n.classList.toggle(t.styles.nodeDropBefore,o===h.BEFORE),n.classList.toggle(t.styles.nodeDropInside,o===h.INSIDE),n.classList.toggle(t.styles.nodeDropAfter,o===h.AFTER)})(e,t)},y=(e,t)=>{f(e,t)},w=(e,t)=>{e.target.classList.remove(t.styles.nodeDragging),f(e,t)},L=e=>`sortableTreeState-${e.replace(/[^\w]+/,"-")}`,_=class{constructor({nodes:e,element:t,renderLabel:n,icons:l,styles:c,lockRootLevel:u,onChange:h,onClick:p,initCollapseLevel:m,confirm:g,disableSorting:f,stateId:v}){this.nodeCollection={},e&&(t?(this.defineElements(),this.root=t,this.icons=Object.assign(Object.assign({},r),l),this.styles=Object.assign(Object.assign({},s),c),this.renderLabel=n||o,this.lockRootLevel=void 0===u||u,this.onChange=h||a,this.onClick=p||i,this.confirm=g||d,this.initCollapseLevel=void 0===m?2:m,this.disableSorting=f||!1,t.classList.add(this.styles.tree),this.render({nodes:e,element:t}),v&&(((e,t)=>{const n=sessionStorage.getItem(L(e));if(!n)return;const o=JSON.parse(n),r=(e,t)=>{const[n,o]=t;e.element.collapse(0===n),o&&e.subnodes.forEach(((e,t)=>{void 0!==o[t]&&r(e,o[t])}))};t.forEach(((e,t)=>{r(e,o[t])}))})(v,this.parseTree(this.root)),this.initStateObserver(v))):console.error('Error: "element" is not a valid HTML element!'))}getNode(e){return this.nodeCollection[e]}findNode(e,t){const n=Object.values(this.nodeCollection);for(let o=0;o<n.length;o++){const r=n[o],s=r.data;if(e in s&&s[e]==t)return r}return null}onDrop(e,t,n){const o={nodes:this.parseTree(this.root),movedNode:e,srcParentNode:t,targetParentNode:n};n.collapse(!1),this.onChange(o)}destroy(){this.observer.disconnect(),this.observer=null}initStateObserver(e){const t=new MutationObserver((()=>{((e,t)=>{const n=[],o=e=>{const t=[],n=[e.element.getAttribute("open")?1:0,t];return e.subnodes.forEach((e=>{t.push(o(e))})),n};t.forEach((e=>{n.push(o(e))})),sessionStorage.setItem(L(e),JSON.stringify(n))})(e,this.parseTree(this.root))}));t.observe(this.root,{childList:!0,attributes:!0,subtree:!0})}defineElements(){try{customElements.define(c.TAG_NAME,c)}catch(e){}}render({nodes:e,element:t},n=0){n++,e.forEach((e=>{const o=c.create({icons:this.icons,styles:this.styles,parent:t,renderLabel:this.renderLabel,data:e.data,onClick:this.onClick,draggable:!this.disableSorting});this.disableSorting||((e,t)=>{const n={dragstart:v,drop:b,dragover:E,dragend:w,dragleave:y};for(const[o,r]of Object.entries(n))u({node:e,eventName:o,handler:r,tree:t})})(o,this),o.collapse(n>this.initCollapseLevel),this.nodeCollection[o.id]=o,e.nodes&&this.render({nodes:e.nodes,element:o.subnodes},n)}))}parseTree(e){const t=Array.from(e.querySelectorAll(`:scope > ${c.TAG_NAME}`)),n=[];return t.forEach((e=>{n.push({element:e,id:e.id,subnodes:this.parseTree(e.subnodes)})})),n}};new _({nodes:e,element:document.getElementById("tree-basic"),stateId:"tree-basic"});new _({nodes:e,element:document.getElementById("tree-confirm"),stateId:"tree-confirm",confirm:(e,t)=>{return n=void 0,o=void 0,s=function*(){const n=e.data.title,o=t.data.title;return confirm(`Do you really want to move "${n}" into "${o}"?`)},new((r=void 0)||(r=Promise))((function(e,t){function a(e){try{d(s.next(e))}catch(e){t(e)}}function i(e){try{d(s.throw(e))}catch(e){t(e)}}function d(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(a,i)}d((s=s.apply(n,o||[])).next())}));var n,o,r,s}}),new _({nodes:e,element:document.getElementById("tree-icons"),icons:{collapsed:'<span class="my-icon"></span>',open:'<span class="my-icon"></span>'},stateId:"tree-icons"}),new _({nodes:e,element:document.getElementById("tree-labels"),stateId:"tree-labels",renderLabel:({title:e,path:t})=>`\n\t\t\t<span>\n\t\t\t\t<span>⌘ ${e}</span>\n\t\t\t\t<span>↕</span>\n\t\t\t</span>\n\t\t`});const C=document.getElementById("reveal-button"),A=new _({nodes:e,element:document.getElementById("tree-find"),stateId:"tree-find",initCollapseLevel:1});C.addEventListener("click",(e=>{e.preventDefault(),A.findNode("title","Deep Nested Page").reveal()}));new _({nodes:e,element:document.getElementById("tree-no-sort"),stateId:"tree-no-sort",initCollapseLevel:1,disableSorting:!0,onClick:(e,t)=>{return n=void 0,o=void 0,s=function*(){alert(`You clicked on "${t.data.title}".`)},new((r=void 0)||(r=Promise))((function(e,t){function a(e){try{d(s.next(e))}catch(e){t(e)}}function i(e){try{d(s.throw(e))}catch(e){t(e)}}function d(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(a,i)}d((s=s.apply(n,o||[])).next())}));var n,o,r,s}});new _({nodes:e,element:document.getElementById("tree-onchange"),stateId:"tree-onchange",onChange:({nodes:e,movedNode:t,srcParentNode:n,targetParentNode:o})=>{return r=void 0,s=void 0,i=function*(){alert("Check out the browser's console to see the updated node data."),console.log({nodes:e,movedNode:t,srcParentNode:n,targetParentNode:o})},new((a=void 0)||(a=Promise))((function(e,t){function n(e){try{d(i.next(e))}catch(e){t(e)}}function o(e){try{d(i.throw(e))}catch(e){t(e)}}function d(t){var r;t.done?e(t.value):(r=t.value,r instanceof a?r:new a((function(e){e(r)}))).then(n,o)}d((i=i.apply(r,s||[])).next())}));var r,s,a,i}});new _({nodes:e,element:document.getElementById("tree-onclick"),stateId:"tree-onclick",onClick:(e,t)=>{return n=void 0,o=void 0,s=function*(){alert(`You clicked on "${t.data.title}".`)},new((r=void 0)||(r=Promise))((function(e,t){function a(e){try{d(s.next(e))}catch(e){t(e)}}function i(e){try{d(s.throw(e))}catch(e){t(e)}}function d(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(a,i)}d((s=s.apply(n,o||[])).next())}));var n,o,r,s}}),new _({nodes:e,element:document.getElementById("tree-unlock-root"),lockRootLevel:!1,stateId:"tree-unlock-root"}),new _({nodes:e,element:document.getElementById("tree-unstyled"),stateId:"tree-unstyled",initCollapseLevel:4,styles:{tree:"my-tree",node:"my-tree__node",label:"my-tree__label",subnodes:"my-tree__subnodes",collapse:"my-tree__collapse"}})})()})();