/*! For license information please see main.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SortableTree=t():e.SortableTree=t()}(self,(()=>(()=>{"use strict";var e={d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{default:()=>m});const o=e=>e.title,n={tree:"tree",node:"tree__node",nodeHover:"tree__node--hover",nodeDropBefore:"tree__node--drop-before",nodeDropInside:"tree__node--drop-inside",nodeDropAfter:"tree__node--drop-after",label:"tree__label",subnodes:"tree__subnodes",collapse:"tree__collapse"},r=e=>{},s=(e,t)=>{return o=void 0,n=void 0,s=function*(){return!0},new((r=void 0)||(r=Promise))((function(e,t){function l(e){try{i(s.next(e))}catch(e){t(e)}}function a(e){try{i(s.throw(e))}catch(e){t(e)}}function i(t){var o;t.done?e(t.value):(o=t.value,o instanceof r?o:new r((function(e){e(o)}))).then(l,a)}i((s=s.apply(o,n||[])).next())}));var o,n,r,s},l=(e,t=[],o=null)=>{const n=document.createElement(e);return t.forEach((e=>{n.classList.add(e)})),o&&o.appendChild(n),n};class a extends HTMLElement{static create({data:e,renderLabel:t,styles:o,parent:n}){const r=l(a.TAG_NAME,[o.node],n),s=l("div",[o.label],r),i=l("div",[o.subnodes],r),d=l("span",[o.collapse],r);return s.innerHTML=t(e),d.innerHTML=v.ICON_COLLAPSED,d.addEventListener("click",r.toggle.bind(r)),r._data=e,r._label=s,r._nodes=i,r.collapseButton=d,r}get data(){return this._data}get label(){return this._label}get subnodes(){return this._nodes}get guid(){return this._guid}constructor(){super(),this._guid=(()=>{const e=()=>Math.floor(65536*(1+Math.random())).toString(16).substring(1);return`${e()}${e()}-${e()}-${e()}-${e()}-${e()}${e()}${e()}`})()}connectedCallback(){this.setAttribute("draggable","true")}collapse(e){e?(this.removeAttribute("open"),this.collapseButton.innerHTML=v.ICON_COLLAPSED):(this.setAttribute("open","true"),this.collapseButton.innerHTML=v.ICON_OPEN)}toggle(){this.collapse(this.hasAttribute("open"))}reveal(){((e,t)=>{const o=[];let n=this.closest(e);for(;null!==n;)o.push(n),n=n.parentNode.closest(e);return o})(a.TAG_NAME).forEach((e=>{e.collapse(!1)}))}}a.TAG_NAME="tree-node";const i=({node:e,eventName:t,handler:o,tree:n})=>{e.addEventListener(t,(e=>{o(e,n)}),!1)};var d;!function(e){e.BEFORE="BEFORE",e.INSIDE="INSIDE",e.AFTER="AFTER"}(d||(d={}));const c=e=>{const t=e.clientY,o=p(e).label.getBoundingClientRect(),n=Math.round(o.height/4);return o.top+n>t?d.BEFORE:o.bottom-n<t?d.AFTER:d.INSIDE},p=e=>e.target.closest(a.TAG_NAME),u=(e,t)=>{p(e).classList.remove(t.styles.nodeDropAfter,t.styles.nodeDropBefore,t.styles.nodeDropInside)},h=(e,t)=>{e.stopPropagation();const o=e.target;o.tagName.toLowerCase()===a.TAG_NAME&&(e.dataTransfer.setData("text",o.guid),e.dataTransfer.effectAllowed="move")},f=(e,t)=>{e.stopPropagation(),e.preventDefault(),u(e,t);const o=p(e);if(!o)return!1;const n=o.parentElement.parentElement,r=e.dataTransfer.getData("text"),s=c(e),l=t.getNode(r);if(l.contains(o))return!1;if(t.lockRootLevel&&!o.parentElement.closest(a.TAG_NAME)&&(s===d.BEFORE||s===d.AFTER))return!1;if(!t.confirm(l,n))return!1;if(s===d.BEFORE)return o.parentNode.insertBefore(l,o),t.onDrop(l,n),!1;if(s===d.AFTER){const e=o.nextElementSibling;return e?(o.parentNode.insertBefore(l,e),t.onDrop(l,n)):(o.parentNode.appendChild(l),t.onDrop(l,n)),!1}return o.subnodes.appendChild(l),t.onDrop(l,o),!1},g=(e,t)=>{e.preventDefault(),e.dataTransfer.dropEffect="move",((e,t)=>{const o=p(e),n=c(e);o.classList.toggle(t.styles.nodeDropBefore,n===d.BEFORE),o.classList.toggle(t.styles.nodeDropInside,n===d.INSIDE),o.classList.toggle(t.styles.nodeDropAfter,n===d.AFTER)})(e,t)},E=(e,t)=>{u(e,t)},b=(e,t)=>{u(e,t)};class v{constructor({nodes:e,element:t,renderLabel:l,styles:a,lockRootLevel:i,onChange:d,initCollapseLevel:c,confirm:p}){this.nodeCollection={},this.defineElements(),this.root=t,this.styles=Object.assign(n,a),this.renderLabel=l||o,this.lockRootLevel=void 0===i||i,this.onChange=d||r,this.confirm=p||s,this.initCollapseLevel=void 0===c?2:c,t.classList.add(this.styles.tree),this.render({nodes:e,element:t})}getNode(e){return this.nodeCollection[e]}findNode(e,t){const o=Object.values(this.nodeCollection);for(let n=0;n<o.length;n++){const r=o[n],s=r.data;if(e in s&&s[e]==t)return r}return null}onDrop(e,t){const o={nodes:this.parseTree(this.root),moved:e,parentNode:t};t.collapse(!1),this.onChange(o)}defineElements(){try{customElements.define(a.TAG_NAME,a)}catch(e){}}render({nodes:e,element:t},o=0){o++,e.forEach((e=>{const n=a.create({styles:this.styles,parent:t,renderLabel:this.renderLabel,data:e.data});((e,t)=>{const o={dragstart:h,drop:f,dragover:g,dragend:b,dragleave:E};for(const[n,r]of Object.entries(o))i({node:e,eventName:n,handler:r,tree:t})})(n,this),n.collapse(o>this.initCollapseLevel),this.nodeCollection[n.guid]=n,e.nodes&&this.render({nodes:e.nodes,element:n.subnodes},o)}))}parseTree(e){const t=Array.from(e.querySelectorAll(`:scope > ${a.TAG_NAME}`)),o=[];return t.forEach((e=>{o.push({element:e,guid:e.guid,subnodes:this.parseTree(e.subnodes)})})),o}}v.ICON_COLLAPSED='<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-caret-right-fill" viewBox="0 0 16 16"><path d="m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"/></svg>',v.ICON_OPEN='<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-caret-down-fill" viewBox="0 0 16 16"><path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/></svg>';const m=v;return t.default})()));